# CoatVision Deployment Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CoatVision System                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Mobile App     â”‚         â”‚   Dashboard      â”‚         â”‚   Backend API    â”‚
â”‚  (React Native)  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚    (React)       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚    (FastAPI)     â”‚
â”‚                  â”‚         â”‚                  â”‚         â”‚                  â”‚
â”‚  ğŸ“± iOS/Android  â”‚         â”‚  ğŸŒ Web Browser  â”‚         â”‚  ğŸ Python 3.11  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                             â”‚                             â”‚
        â”‚                             â”‚                             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   OpenAI     â”‚
                              â”‚     API      â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Render Deployment Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Render Platform                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Blueprint Deployment (render.yaml)                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                         â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚           â”‚                           â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Backend Service   â”‚    â”‚  Frontend Service   â”‚              â”‚
â”‚  â”‚  (Web Service)     â”‚    â”‚  (Static Site)      â”‚              â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
â”‚  â”‚ â€¢ Python 3.11      â”‚    â”‚ â€¢ Node.js 18+       â”‚              â”‚
â”‚  â”‚ â€¢ FastAPI          â”‚    â”‚ â€¢ Vite Build        â”‚              â”‚
â”‚  â”‚ â€¢ uvicorn          â”‚    â”‚ â€¢ React             â”‚              â”‚
â”‚  â”‚ â€¢ OpenCV           â”‚    â”‚ â€¢ SPA Routing       â”‚              â”‚
â”‚  â”‚ â€¢ ReportLab        â”‚    â”‚                     â”‚              â”‚
â”‚  â”‚                    â”‚    â”‚                     â”‚              â”‚
â”‚  â”‚ Health: /health    â”‚â—€â”€â”€â”€â”¤ API Proxy           â”‚              â”‚
â”‚  â”‚ Port: $PORT        â”‚    â”‚ Dist: ./dist        â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚           â”‚                                                       â”‚
â”‚           â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚  â”‚  Environment Vars  â”‚                                          â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                          â”‚
â”‚  â”‚ â€¢ SECRET_KEY       â”‚                                          â”‚
â”‚  â”‚ â€¢ OPENAI_API_KEY   â”‚                                          â”‚
â”‚  â”‚ â€¢ DATABASE_URL     â”‚                                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Deployment Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Developer   â”‚
â”‚   Machine    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ git push
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    GitHub    â”‚
â”‚  Repository  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Webhook
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Render Platform              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  1. Detect render.yaml               â”‚
â”‚  2. Clone repository                 â”‚
â”‚  3. Build services:                  â”‚
â”‚     â”œâ”€ Backend:  ./build.sh          â”‚
â”‚     â””â”€ Frontend: npm ci && npm build â”‚
â”‚  4. Deploy services                  â”‚
â”‚  5. Assign URLs                      â”‚
â”‚  6. Health checks                    â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Live Services                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  https://coatvision-backend.         â”‚
â”‚         onrender.com                 â”‚
â”‚                                      â”‚
â”‚  https://coatvision-dashboard.       â”‚
â”‚         onrender.com                 â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## File Structure for Deployment

```
CoatVision_MVP/
â”œâ”€â”€ render.yaml                    # ğŸ”§ Blueprint configuration
â”œâ”€â”€ Procfile                       # ğŸ”§ Alternative deployment
â”œâ”€â”€ DEPLOYMENT.md                  # ğŸ“– Full guide (English)
â”œâ”€â”€ DEPLOYMENT_NO.md              # ğŸ“– Full guide (Norwegian)
â”œâ”€â”€ QUICK_DEPLOY.md               # ğŸ“– Quick start
â”‚
â”œâ”€â”€ backend/                       # ğŸ Backend Service
â”‚   â”œâ”€â”€ main.py                   # Entry point
â”‚   â”œâ”€â”€ requirements.txt          # Python dependencies
â”‚   â”œâ”€â”€ build.sh                  # ğŸ”§ Build script
â”‚   â”œâ”€â”€ Dockerfile                # ğŸ”§ Docker config
â”‚   â”œâ”€â”€ .dockerignore             # Docker ignore
â”‚   â””â”€â”€ routers/                  # API routes
â”‚
â”œâ”€â”€ frontend/                      # âš›ï¸ Frontend Service
â”‚   â”œâ”€â”€ package.json              # ğŸ”§ Dependencies
â”‚   â”œâ”€â”€ vite.config.js            # ğŸ”§ Build config
â”‚   â”œâ”€â”€ index.html                # ğŸ”§ Entry point
â”‚   â”œâ”€â”€ .eslintrc.json            # Linting
â”‚   â””â”€â”€ src/                      # Source code
â”‚       â”œâ”€â”€ main.jsx              # React entry
â”‚       â”œâ”€â”€ App.jsx               # Main app
â”‚       â”œâ”€â”€ components/           # Components
â”‚       â””â”€â”€ pages/                # Pages
â”‚
â””â”€â”€ mobile/                        # ğŸ“± Mobile App
    â”œâ”€â”€ package.json              # Not deployed to Render
    â””â”€â”€ src/                      # Use Expo/App Stores
```

## URLs After Deployment

### Production URLs (Render)
- **Backend API**: `https://coatvision-backend.onrender.com`
- **Backend Health**: `https://coatvision-backend.onrender.com/health`
- **Frontend Dashboard**: `https://coatvision-dashboard.onrender.com`

### Local Development URLs
- **Backend API**: `http://localhost:8000`
- **Backend Health**: `http://localhost:8000/health`
- **Frontend Dashboard**: `http://localhost:3000`
- **Mobile App**: Expo Go app or emulator

## Environment Variables Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Render Config  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                 â”‚
         â–¼                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Backend     â”‚              â”‚     Frontend     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SECRET_KEY     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ VITE_API_URL     â”‚
â”‚ OPENAI_API_KEY â”‚              â”‚ (auto-linked)    â”‚
â”‚ DATABASE_URL   â”‚              â”‚ NODE_ENV         â”‚
â”‚ PYTHON_VERSION â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ PORT (auto)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Health Checks

```
Render Monitor
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Health Check    â”‚
â”‚  GET /health     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Response:       â”‚
â”‚  {               â”‚
â”‚   "status":      â”‚
â”‚    "healthy"     â”‚
â”‚  }               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    âœ… Service OK
```

## Build Process

### Backend Build
```
1. Install Python 3.11
2. Run build.sh:
   â”œâ”€ Update pip
   â”œâ”€ Install requirements.txt
   â””â”€ Create uploads/ and outputs/ directories
3. Start: uvicorn main:app --host 0.0.0.0 --port $PORT
4. Health check: /health
```

### Frontend Build
```
1. Install Node.js 18+
2. Run build commands:
   â”œâ”€ npm ci (install dependencies)
   â””â”€ npm run build (Vite build)
3. Output: dist/ directory
4. Serve static files
5. SPA routing: /* â†’ /index.html
```

## Scaling Options

```
Free Tier                      Paid Tier
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 750 hours/month â”‚           â”‚ Always-on       â”‚
â”‚ Spins down      â”‚    â†’      â”‚ No cold starts  â”‚
â”‚ 30-60s startup  â”‚           â”‚ More resources  â”‚
â”‚ 512 MB RAM      â”‚           â”‚ 1-4 GB RAM      â”‚
â”‚ Free SSL        â”‚           â”‚ Free SSL        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      $0/month                    $7-25/month
```

## Security

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Security Layers              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  ğŸ”’ HTTPS (Auto SSL)                   â”‚
â”‚  ğŸ” Environment Variables (Encrypted)  â”‚
â”‚  ğŸ›¡ï¸  CORS (Configured)                 â”‚
â”‚  ğŸ”‘ API Keys (Not in code)             â”‚
â”‚  ğŸ“ No secrets in Git                  â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Monitoring

```
Render Dashboard
     â”‚
     â”œâ”€â”€â–¶ Logs (Real-time)
     â”œâ”€â”€â–¶ Metrics (CPU, Memory)
     â”œâ”€â”€â–¶ Deploy History
     â””â”€â”€â–¶ Health Status
```

## Next Steps After Deployment

1. âœ… Verify services are running
2. âœ… Test API endpoints
3. âœ… Test frontend functionality
4. âœ… Configure custom domain (optional)
5. âœ… Set up monitoring/alerts
6. âœ… Update mobile app API URL
7. âœ… Document API for team

---

**Legend:**
- ğŸ”§ = Configuration file
- ğŸ“– = Documentation
- ğŸ = Python/Backend
- âš›ï¸ = React/Frontend
- ğŸ“± = Mobile
- âœ… = Completed/Working
- âŒ = Not included
